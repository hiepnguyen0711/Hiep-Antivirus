{"timestamp":"2025-07-19 12:47:52","url":"http:\/\/localhost\/2025\/Hiep-Antivirus\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 12:47:55","url":"https:\/\/hiepcodeweb.com\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 12:47:57","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 12:48:05","url":"http:\/\/localhost\/2025\/Hiep-Antivirus\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 12:48:05","url":"https:\/\/hiepcodeweb.com\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 12:48:06","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 12:48:11","url":"http:\/\/localhost\/2025\/Hiep-Antivirus\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 12:48:11","url":"https:\/\/hiepcodeweb.com\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 12:48:12","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 12:48:21","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 12:48:26","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=get_file&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":{"file_path":".\/config\/scanner_config.php"},"headers":["Content-Type: application\/json","Accept: application\/json"]}
{"timestamp":"2025-07-19 12:52:11","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=get_file&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":{"file_path":".\/index.php"},"headers":["Content-Type: application\/json","Accept: application\/json"]}
{"timestamp":"2025-07-19 12:57:04","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 13:00:07","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 13:02:50","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 13:09:48","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 13:20:24","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 13:23:02","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 13:24:54","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=get_file&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":{"file_path":".\/config\/scanner_config.php"},"headers":["Content-Type: application\/json","Accept: application\/json"]}
{"timestamp":"2025-07-19 13:25:06","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=save_file&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":{"file_path":".\/config\/scanner_config.php","content":"<?php\n\/**\n * Security Scanner Configuration\n * C\u1ea5u h\u00ecnh t\u1eadp trung cho h\u1ec7 th\u1ed1ng qu\u00e9t malware\n * Author: Hi\u1ec7p Nguy\u1ec5n\n * Version: 2.0\n *\/\n\/\/ test\n\/\/ ==================== CLIENT CONFIGURATION ====================\nclass SecurityScannerConfig {\n    \/\/ API Security\n    const DEFAULT_API_KEY = 'hiep-security-client-2025-change-this-key';\n    const CLIENT_VERSION = '2.0';\n    \n    \/\/ Scan Limits\n    const MAX_SCAN_FILES = 15000;\n    const MAX_SCAN_TIME = 600; \/\/ 10 ph\u00fat\n    const MAX_MEMORY = '512M';\n    const MAX_FILE_SIZE = 50 * 1024 * 1024; \/\/ 50MB\n    \n    \/\/ Security\n    const RATE_LIMIT = 20; \/\/ S\u1ed1 request\/ph\u00fat\n    const SESSION_TIMEOUT = 3600; \/\/ 1 gi\u1edd\n    \n    \/\/ Directories to exclude from scanning\n    const EXCLUDE_DIRS = [\n        '.git', '.svn', '.hg', '.bzr',\n        'node_modules', 'vendor', 'bower_components',\n        'cache', 'logs', 'tmp', 'temp', 'uploads',\n        'quarantine', 'backup', 'backups'\n    ];\n    \n    \/\/ Files to exclude from scanning\n    const EXCLUDE_FILES = [\n        'security_scan_client.php',\n        'security_scan_server.php',\n        'scanner_config.php',\n        '.htaccess', '.htpasswd',\n        'robots.txt', 'sitemap.xml'\n    ];\n    \n    \/\/ File extensions to scan\n    const SCAN_EXTENSIONS = [\n        'php', 'php3', 'php4', 'php5', 'php7', 'php8',\n        'phtml', 'phps', 'pht', 'phar',\n        'inc', 'class', 'module'\n    ];\n    \n    \/\/ Suspicious file extensions\n    const SUSPICIOUS_EXTENSIONS = [\n        '.php.txt', '.php.bak', '.php.old', '.php.tmp',\n        '.php.backup', '.php.orig', '.php.save',\n        '.suspected', '.virus', '.malware'\n    ];\n}\n\n\/\/ ==================== SERVER CONFIGURATION ====================\nclass SecurityServerConfig {\n    \/\/ Email Settings\n    const ADMIN_EMAIL = 'nguyenvanhiep0711@gmail.com';\n    const EMAIL_FROM = 'security-server@yourdomain.com';\n    const EMAIL_FROM_NAME = 'Hi\u1ec7p Security Server';\n    \n    \/\/ SMTP Settings\n    const SMTP_HOST = 'smtp.gmail.com';\n    const SMTP_PORT = 587;\n    const SMTP_USERNAME = 'nguyenvanhiep0711@gmail.com';\n    const SMTP_PASSWORD = 'flnd neoz lhqw yzmd';\n    const SMTP_SECURE = 'tls';\n    \n    \/\/ Server Settings\n    const SERVER_NAME = 'Hi\u1ec7p Security Center';\n    const SERVER_VERSION = '2.0';\n    const MAX_CONCURRENT_SCANS = 15;\n    const SCAN_TIMEOUT = 600; \/\/ 10 ph\u00fat\n    \n    \/\/ Dashboard Settings\n    const AUTO_REFRESH_INTERVAL = 30; \/\/ seconds\n    const MAX_SCAN_HISTORY = 100;\n    const ALERT_THRESHOLD_CRITICAL = 1;\n    const ALERT_THRESHOLD_SUSPICIOUS = 10;\n}\n\n\/\/ ==================== MALWARE PATTERNS ====================\nclass MalwarePatterns {\n    \n    public static function getCriticalPatterns() {\n        return [\n            \/\/ Code Execution - Critical\n            'eval(' => 'Direct code execution vulnerability',\n            'assert(' => 'Code assertion execution',\n            'system(' => 'Direct system command execution',\n            'exec(' => 'System command execution',\n            'shell_exec(' => 'Shell command execution',\n            'passthru(' => 'Command output bypass execution',\n            'popen(' => 'Process pipe execution',\n            'proc_open(' => 'Process execution with pipes',\n            \n            \/\/ Encoding\/Obfuscation - Critical\n            'base64_decode(' => 'Base64 encoded payload execution',\n            'gzinflate(' => 'Compressed malware payload',\n            'gzuncompress(' => 'Compressed data decompression',\n            'str_rot13(' => 'ROT13 string obfuscation',\n            'convert_uudecode(' => 'UU encoding obfuscation',\n            'hex2bin(' => 'Hexadecimal to binary conversion',\n            \n            \/\/ File Operations - Critical\n            'file_put_contents(' => 'Potentially malicious file writing',\n            'fwrite(' => 'Direct file writing operation',\n            'fputs(' => 'File output operation',\n            \n            \/\/ Network Operations - Critical\n            'fsockopen(' => 'Socket connection establishment',\n            'socket_create(' => 'Raw socket creation',\n            'curl_exec(' => 'HTTP request execution',\n            \n            \/\/ Webshell Indicators - Critical\n            'move_uploaded_file(' => 'File upload processing',\n            'copy(' => 'File copying operation',\n            'rename(' => 'File renaming operation',\n            'unlink(' => 'File deletion operation',\n            'rmdir(' => 'Directory removal operation',\n            'mkdir(' => 'Directory creation operation',\n            \n            \/\/ Database Operations - Critical\n            'mysql_query(' => 'Direct MySQL query execution',\n            'mysqli_query(' => 'MySQLi query execution',\n            'pg_query(' => 'PostgreSQL query execution'\n        ];\n    }\n    \n    public static function getSuspiciousPatterns() {\n        return [\n            \/\/ File Operations\n            'file_get_contents(' => 'File reading operation',\n            'fopen(' => 'File handle creation',\n            'fread(' => 'File reading operation',\n            'readfile(' => 'Direct file output',\n            'include(' => 'File inclusion',\n            'require(' => 'File requirement',\n            'include_once(' => 'Single file inclusion',\n            'require_once(' => 'Single file requirement',\n            \n            \/\/ String Operations\n            'preg_replace(' => 'Regular expression replacement',\n            'str_replace(' => 'String replacement operation',\n            'substr(' => 'String substring operation',\n            'chr(' => 'Character generation',\n            'ord(' => 'Character code conversion',\n            \n            \/\/ Array Operations\n            'array_map(' => 'Array mapping function',\n            'array_filter(' => 'Array filtering function',\n            'call_user_func(' => 'Dynamic function calling',\n            'call_user_func_array(' => 'Dynamic function calling with arrays',\n            \n            \/\/ Variable Operations\n            'extract(' => 'Variable extraction from array',\n            'parse_str(' => 'String parsing to variables',\n            'variable_get(' => 'Variable retrieval',\n            \n            \/\/ HTTP Operations\n            'header(' => 'HTTP header manipulation',\n            'setcookie(' => 'Cookie setting operation',\n            'session_start(' => 'Session initialization',\n            \n            \/\/ User Input\n            '$_GET[' => 'GET parameter processing',\n            '$_POST[' => 'POST parameter processing',\n            '$_REQUEST[' => 'REQUEST parameter processing',\n            '$_COOKIE[' => 'Cookie parameter processing'\n        ];\n    }\n    \n    public static function getWebshellPatterns() {\n        return [\n            \/\/ Common webshell signatures\n            '\/\\$_(GET|POST|REQUEST)\\s*\\[\\s*[\\'\"][^\\'\\\"]*[\\'\"]\\s*\\]\\s*\\(\\s*\\$_(GET|POST|REQUEST)\/i' => 'Dynamic function execution via HTTP parameters',\n            '\/eval\\s*\\(\\s*\\$_(GET|POST|REQUEST|COOKIE)\/i' => 'Direct eval() with user input',\n            '\/system\\s*\\(\\s*\\$_(GET|POST|REQUEST)\/i' => 'System command execution via HTTP',\n            '\/exec\\s*\\(\\s*\\$_(GET|POST|REQUEST)\/i' => 'Command execution via HTTP parameters',\n            '\/shell_exec\\s*\\(\\s*\\$_(GET|POST|REQUEST)\/i' => 'Shell execution via HTTP parameters',\n            '\/passthru\\s*\\(\\s*\\$_(GET|POST|REQUEST)\/i' => 'Passthru execution via HTTP parameters',\n            '\/base64_decode\\s*\\(\\s*\\$_(GET|POST|REQUEST)\/i' => 'Base64 decode of user input',\n            '\/gzinflate\\s*\\(\\s*base64_decode\/i' => 'Compressed and encoded payload',\n            '\/str_rot13\\s*\\(\\s*base64_decode\/i' => 'ROT13 and Base64 obfuscation',\n            \n            \/\/ File operation webshells\n            '\/file_put_contents\\s*\\(\\s*\\$_(GET|POST|REQUEST)\/i' => 'File writing via HTTP parameters',\n            '\/fwrite\\s*\\(\\s*.*\\$_(GET|POST|REQUEST)\/i' => 'File writing with user input',\n            '\/move_uploaded_file\\s*\\(\\s*\\$_FILES\/i' => 'File upload processing',\n            \n            \/\/ Common webshell names and patterns\n            '\/c99|r57|wso|b374k|adminer|shell|backdoor\/i' => 'Known webshell signature',\n            '\/\\$[a-zA-Z_][a-zA-Z0-9_]*\\s*=\\s*\\$_(GET|POST|REQUEST).*eval\/i' => 'Variable assignment and eval pattern',\n            \n            \/\/ Obfuscated patterns\n            '\/chr\\s*\\(\\s*\\d+\\s*\\)\\s*\\.\\s*chr\\s*\\(\\s*\\d+\\s*\\)\/i' => 'Character concatenation obfuscation',\n            '\/\\\\\\\\x[0-9a-f]{2}\/i' => 'Hexadecimal character encoding',\n            \n            \/\/ PHP webshell specific\n            '\/assert\\s*\\(\\s*\\$_(GET|POST|REQUEST)\/i' => 'Assert function with user input',\n            '\/preg_replace.*\\\/e.*\\$_(GET|POST|REQUEST)\/i' => 'Preg_replace with eval modifier',\n            '\/create_function\\s*\\(.*\\$_(GET|POST|REQUEST)\/i' => 'Dynamic function creation with user input'\n        ];\n    }\n    \n    public static function getKnownMalwareSignatures() {\n        return [\n            \/\/ Known malware MD5 hashes\n            'md5_hashes' => [\n                '5d41402abc4b2a76b9719d911017c592' => 'Known malware sample',\n                \/\/ Th\u00eam c\u00e1c hash MD5 c\u1ee7a malware \u0111\u00e3 bi\u1ebft\n            ],\n            \n            \/\/ Known malware file names\n            'file_names' => [\n                'c99.php', 'r57.php', 'wso.php', 'b374k.php',\n                'adminer.php', 'shell.php', 'backdoor.php',\n                'webshell.php', 'cmd.php', 'bypass.php'\n            ],\n            \n            \/\/ Suspicious file patterns\n            'file_patterns' => [\n                '\/^[a-f0-9]{32}\\.php$\/', \/\/ MD5 named files\n                '\/^[0-9]+\\.php$\/', \/\/ Numeric named files\n                '\/^\\..*\\.php$\/', \/\/ Hidden PHP files\n                '\/^[a-zA-Z]{1,3}\\.php$\/' \/\/ Very short named files\n            ]\n        ];\n    }\n}\n\n\/\/ ==================== UTILITY FUNCTIONS ====================\nclass ScannerUtils {\n    \n    public static function isWhitelisted($filePath) {\n        $whitelistFile = '.\/config\/whitelist.json';\n        if (!file_exists($whitelistFile)) {\n            return false;\n        }\n        \n        $whitelist = json_decode(file_get_contents($whitelistFile), true) ?: [];\n        return isset($whitelist[$filePath]);\n    }\n    \n    public static function logSecurityEvent($message, $level = 'INFO') {\n        $logFile = '.\/logs\/security_events_' . date('Y-m-d') . '.log';\n        $logEntry = date('Y-m-d H:i:s') . \" [$level] $message\\n\";\n        \n        if (!file_exists('.\/logs')) {\n            mkdir('.\/logs', 0755, true);\n        }\n        \n        file_put_contents($logFile, $logEntry, FILE_APPEND | LOCK_EX);\n    }\n    \n    public static function formatFileSize($bytes) {\n        $units = ['B', 'KB', 'MB', 'GB'];\n        $bytes = max($bytes, 0);\n        $pow = floor(($bytes ? log($bytes) : 0) \/ log(1024));\n        $pow = min($pow, count($units) - 1);\n        \n        $bytes \/= pow(1024, $pow);\n        \n        return round($bytes, 2) . ' ' . $units[$pow];\n    }\n    \n    public static function getClientIP() {\n        $ipKeys = ['HTTP_CF_CONNECTING_IP', 'HTTP_CLIENT_IP', 'HTTP_X_FORWARDED_FOR', 'REMOTE_ADDR'];\n        \n        foreach ($ipKeys as $key) {\n            if (array_key_exists($key, $_SERVER) === true) {\n                foreach (explode(',', $_SERVER[$key]) as $ip) {\n                    $ip = trim($ip);\n                    if (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE) !== false) {\n                        return $ip;\n                    }\n                }\n            }\n        }\n        \n        return $_SERVER['REMOTE_ADDR'] ?? 'unknown';\n    }\n}\n"},"headers":["Content-Type: application\/json","Accept: application\/json"]}
{"timestamp":"2025-07-19 13:30:51","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 13:31:23","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=get_file&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":{"file_path":".\/index.php"},"headers":["Content-Type: application\/json","Accept: application\/json"]}
{"timestamp":"2025-07-19 13:32:14","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=save_file&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":{"file_path":".\/index.php","content":"<?php\nif (!isset($_SESSION)) {\n    \/\/session_set_cookie_params(['SameSite' => 'None']);\n    session_start();\n}\nob_start();\nerror_reporting(0);\n\/\/ka\n\/\/ Hi\u1ec3n th\u1ecb l\u1ed7i start\n\/\/ ini_set('display_errors', 1);\n\/\/ ini_set('display_startup_errors', 1);\n\/\/ error_reporting(E_ALL);\n\/\/ Hi\u1ec3n th\u1ecb l\u1ed5i end\ndefine('_source', '.\/sources\/');\ndefine('_lib', '.\/admin\/lib\/');\ndefine('_source_lib', 'sources\/lib\/');\n\/* Timezone *\/\ndate_default_timezone_set('Asia\/Ho_Chi_Minh');\n\/\/session_destroy();\nglobal $d;\nglobal $lang;\ninclude _lib . \"config.php\";\ninclude_once _lib . \"function.php\";\ninclude_once _lib . \"class.php\";\n$d = new func_index($config['database']);\ninclude_once _source_lib . \"lang.php\";\ninclude_once _source_lib . \"info.php\";\ninclude_once _source_lib . \"function.php\";\ninclude _source_lib . \"file_router_index.php\";\n$ZERO_PATH = _lib . \"Mobile_Detect.php\";\nrequire_once($ZERO_PATH);\n$detect = new Mobile_Detect;\nif (!isset($_SESSION['token'])) {\n    token();\n}\n$url_page = getCurrentPageURL();\n?>\n<!DOCTYPE html>\n<html lang=\"<?= _lang ?>\">\n\n<head>\n    <base href=\"<?= URLPATH ?>\" \/>\n    <meta http-equiv=\"content-type\" content=\"text\/html; charset=utf-8\" \/>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <?php include _source . \"module\/seo.php\" ?>\n    <?php include _source . \"templates\/css.php\" ?>\n    <?php if ($com != '') { ?>\n        <?= $row['seo_head'] ?>\n    <?php } ?>\n    <?php\n    header(\"Cache-Control: public, max-age=86400\");\n    header(\"Expires: \" . gmdate(\"D, d M Y H:i:s\", time() + 86400) . \" GMT\");\n    ?>\n\n    <!-- Google tag (gtag.js) -->\n    <script async src=\"https:\/\/www.googletagmanager.com\/gtag\/js?id=G-G0EBNSSVLJ\"><\/script>\n    <script>\n        window.dataLayer = window.dataLayer || [];\n\n        function gtag() {\n            dataLayer.push(arguments);\n        }\n        gtag('js', new Date());\n\n        gtag('config', 'G-G0EBNSSVLJ');\n    <\/script>\n<\/head>\n\n<body class=\"<?= $source ?>\">\n    <?php \/\/include 'limit.php';\n    ?>\n    <?php include _source . \"all.php\"; ?>\n    <?php\n    if ($source != 'gio-hang') {\n    ?>\n        <!-- Menu mobi start -->\n        <?php include _source . \"module\/menu-mobile.php\"; ?>\n        <!-- Menu mobile end -->\n        <?php include _source . \"_header.php\"; ?>\n    <?php } ?>\n    <?php include _source . \"module\/slider.php\"; ?>\n    <div class=\"wrapper <?php if ($com != '') echo 'wrapper-detail'; ?>\">\n        <?php include _source . $source . \".php\"; ?>\n    <\/div>\n    <?php \/\/include _source . \"module\/doi-tac.php\"; \n    ?>\n    <?php\n    if ($source != 'gio-hang') {\n    ?>\n        <?php include _source . \"_footer.php\"; ?>\n        <?php include _source . \"module\/hotrotructuyen.php\" ?>\n    <?php } ?>\n    <?php \/\/include _source . \"module\/phone.php\"; \n    ?>\n    <?php \/\/include _source . \"module\/mxh_fix.php\"; \n    ?>\n    <?php include _source . \"templates\/js.php\" ?>\n    <?php include 'sitemap\/seo_footer.inc'; ?>\n    <?php if ($com != '') { ?>\n        <?= $row['seo_body'] ?>\n    <?php } ?>\n\n\n    <!-- lenis scroll bar start -->\n    <div class=\"lenis-scrollbar\">\n        <div class=\"lenis-scrollbar-thumb\"><\/div>\n    <\/div>\n    <!-- lenis scroll bar end -->\n    <script async src=\"https:\/\/www.tiktok.com\/embed.js\"><\/script>\n\n<\/body>\n\n<\/html>\n<?php $d->disconnect() ?>"},"headers":["Content-Type: application\/json","Accept: application\/json"]}
{"timestamp":"2025-07-19 13:32:38","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=get_file&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":{"file_path":".\/config\/scanner_config.php"},"headers":["Content-Type: application\/json","Accept: application\/json"]}
{"timestamp":"2025-07-19 13:32:58","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 13:33:04","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=get_file&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":{"file_path":".\/index.php"},"headers":["Content-Type: application\/json","Accept: application\/json"]}
{"timestamp":"2025-07-19 13:34:04","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=save_file&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":{"file_path":".\/index.php","content":"<?php\nif (!isset($_SESSION)) {\n    \/\/session_set_cookie_params(['SameSite' => 'None']);\n    session_start();\n}\nob_start();\nerror_reporting(0);\n\/\/kaaa\n\/\/ Hi\u1ec3n th\u1ecb l\u1ed7i start\n\/\/ ini_set('display_errors', 1);\n\/\/ ini_set('display_startup_errors', 1);\n\/\/ error_reporting(E_ALL);\n\/\/ Hi\u1ec3n th\u1ecb l\u1ed5i end\ndefine('_source', '.\/sources\/');\ndefine('_lib', '.\/admin\/lib\/');\ndefine('_source_lib', 'sources\/lib\/');\n\/* Timezone *\/\ndate_default_timezone_set('Asia\/Ho_Chi_Minh');\n\/\/session_destroy();\nglobal $d;\nglobal $lang;\ninclude _lib . \"config.php\";\ninclude_once _lib . \"function.php\";\ninclude_once _lib . \"class.php\";\n$d = new func_index($config['database']);\ninclude_once _source_lib . \"lang.php\";\ninclude_once _source_lib . \"info.php\";\ninclude_once _source_lib . \"function.php\";\ninclude _source_lib . \"file_router_index.php\";\n$ZERO_PATH = _lib . \"Mobile_Detect.php\";\nrequire_once($ZERO_PATH);\n$detect = new Mobile_Detect;\nif (!isset($_SESSION['token'])) {\n    token();\n}\n$url_page = getCurrentPageURL();\n?>\n<!DOCTYPE html>\n<html lang=\"<?= _lang ?>\">\n\n<head>\n    <base href=\"<?= URLPATH ?>\" \/>\n    <meta http-equiv=\"content-type\" content=\"text\/html; charset=utf-8\" \/>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <?php include _source . \"module\/seo.php\" ?>\n    <?php include _source . \"templates\/css.php\" ?>\n    <?php if ($com != '') { ?>\n        <?= $row['seo_head'] ?>\n    <?php } ?>\n    <?php\n    header(\"Cache-Control: public, max-age=86400\");\n    header(\"Expires: \" . gmdate(\"D, d M Y H:i:s\", time() + 86400) . \" GMT\");\n    ?>\n\n    <!-- Google tag (gtag.js) -->\n    <script async src=\"https:\/\/www.googletagmanager.com\/gtag\/js?id=G-G0EBNSSVLJ\"><\/script>\n    <script>\n        window.dataLayer = window.dataLayer || [];\n\n        function gtag() {\n            dataLayer.push(arguments);\n        }\n        gtag('js', new Date());\n\n        gtag('config', 'G-G0EBNSSVLJ');\n    <\/script>\n<\/head>\n\n<body class=\"<?= $source ?>\">\n    <?php \/\/include 'limit.php';\n    ?>\n    <?php include _source . \"all.php\"; ?>\n    <?php\n    if ($source != 'gio-hang') {\n    ?>\n        <!-- Menu mobi start -->\n        <?php include _source . \"module\/menu-mobile.php\"; ?>\n        <!-- Menu mobile end -->\n        <?php include _source . \"_header.php\"; ?>\n    <?php } ?>\n    <?php include _source . \"module\/slider.php\"; ?>\n    <div class=\"wrapper <?php if ($com != '') echo 'wrapper-detail'; ?>\">\n        <?php include _source . $source . \".php\"; ?>\n    <\/div>\n    <?php \/\/include _source . \"module\/doi-tac.php\"; \n    ?>\n    <?php\n    if ($source != 'gio-hang') {\n    ?>\n        <?php include _source . \"_footer.php\"; ?>\n        <?php include _source . \"module\/hotrotructuyen.php\" ?>\n    <?php } ?>\n    <?php \/\/include _source . \"module\/phone.php\"; \n    ?>\n    <?php \/\/include _source . \"module\/mxh_fix.php\"; \n    ?>\n    <?php include _source . \"templates\/js.php\" ?>\n    <?php include 'sitemap\/seo_footer.inc'; ?>\n    <?php if ($com != '') { ?>\n        <?= $row['seo_body'] ?>\n    <?php } ?>\n\n\n    <!-- lenis scroll bar start -->\n    <div class=\"lenis-scrollbar\">\n        <div class=\"lenis-scrollbar-thumb\"><\/div>\n    <\/div>\n    <!-- lenis scroll bar end -->\n    <script async src=\"https:\/\/www.tiktok.com\/embed.js\"><\/script>\n\n<\/body>\n\n<\/html>\n<?php $d->disconnect() ?>"},"headers":["Content-Type: application\/json","Accept: application\/json"]}
{"timestamp":"2025-07-19 13:40:52","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=scan&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":[],"headers":["Content-Type: application\/json","Accept: application\/json","X-API-Key: {\"priority_files\":[]}"]}
{"timestamp":"2025-07-19 13:41:16","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=get_file&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":{"file_path":".\/sources\/ajax\/get_google_news.php"},"headers":["Content-Type: application\/json","Accept: application\/json"]}
{"timestamp":"2025-07-19 13:41:34","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=get_file&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":{"file_path":".\/sources\/tin-tuc.php"},"headers":["Content-Type: application\/json","Accept: application\/json"]}
{"timestamp":"2025-07-19 13:41:42","url":"https:\/\/xemay365.com.vn\/security_scan_client.php?endpoint=save_file&api_key=hiep-security-client-2025-change-this-key","method":"POST","data":{"file_path":".\/sources\/tin-tuc.php","content":"<?php\n\/\/ test\nif ($com == 'tags') {\n    $tags       = addslashes($_REQUEST['alias']);\n    $query      = $d->simple_fetch(\"SELECT * FROM #_tags WHERE alias = '$tags'\");\n    $tintuc     = $d->o_fet(\"SELECT * FROM #_tintuc \n                             WHERE hien_thi = 1 \n                               AND tags_hienthi LIKE '%\" . $query['ten'] . \"%'\n                             ORDER BY so_thu_tu ASC, id DESC\");\n    \/\/ N\u1ebfu c\u1ea7n pagination cho tags, b\u1ea1n c\u00f3 th\u1ec3 b\u1ed5 sung t\u01b0\u01a1ng t\u1ef1 nh\u01b0 b\u00ean d\u01b0\u1edbi\n} else {\n    $id_loai       = $row['id_code'] . $d->getIdsub($row['id_code']);\n    $total_records = $d->num_rows(\"SELECT * FROM #_tintuc \n                                   WHERE id_loai IN ($id_loai) \n                                     AND hien_thi = 1 \" . _where_lang . \"\n                                   ORDER BY so_thu_tu ASC, id DESC\");\n    $limit       = 6;\n    $total_page  = ceil($total_records \/ $limit);\n    $tintuc      = $d->o_fet(\"SELECT * FROM #_tintuc \n                              WHERE id_loai IN ($id_loai) \n                                AND hien_thi = 1  \" . _where_lang . \"\n                              ORDER BY so_thu_tu ASC, id DESC \n                              LIMIT 0, $limit\");\n}\n\n\/\/ L\u1ea5y \u1ea3nh qu\u1ea3ng c\u00e1o\n$hinh_quang_cao = $d->getContent(1103);\n?>\n<section class=\"xm-news-section-page\">\n  <div class=\"container\">\n    <div class=\"xm-news-section-page-wrapper\">\n      <div class=\"row gx-5 gy-4\">\n        \n        <!-- Main content -->\n        <div class=\"col-12 col-lg-9\">\n          <div class=\"xm-news-section-page-item-left\">\n            \n            <!-- K\u1ebft qu\u1ea3 tin t\u1ee9c (Ajax pagination) -->\n            <div class=\"row row-cols-1 row-cols-md-2 row-cols-lg-3 gx-4 gy-4 xm-news-section-page-content-result\" id=\"result\">\n              <!-- N\u1ed9i dung s\u1ebd \u0111\u01b0\u1ee3c load qua Ajax -->\n            <\/div>\n            \n            <!-- Pagination -->\n            <div class=\"pagination-page text-center pt-3 pb-3 d-flex justify-content-center\">\n              <ul id=\"pagination-ajax\" class=\"pagination-sm\"><\/ul>\n            <\/div>\n            \n          <\/div>\n        <\/div>\n        \n        <!-- Sidebar: Google News + Qu\u1ea3ng c\u00e1o -->\n        <div class=\"col-12 col-lg-3\">\n          \n          <!-- Google News -->\n          <div class=\"google-news-block mb-4 p-3 bg-light rounded\">\n            <h4 class=\"mb-3\">Tin t\u1eeb Google News<\/h4>\n            <ul id=\"google-news-list\" class=\"list-unstyled\">\n              <li>\u0110ang t\u1ea3i...<\/li>\n            <\/ul>\n          <\/div>\n          \n          <!-- Qu\u1ea3ng c\u00e1o -->\n          <div class=\"xm-news-section-page-item-right overflow-hidden rounded-2 shadow-sm\">\n            <a <?= vanhiep_link($hinh_quang_cao) ?>>\n              <img src=\"<?= Img($hinh_quang_cao['hinh_anh']) ?>\" alt=\"\u1ea3nh qu\u1ea3ng c\u00e1o\">\n            <\/a>\n          <\/div>\n        \n        <\/div>\n      <\/div>\n    <\/div>\n  <\/div>\n<\/section>\n\n<!-- Th\u01b0 vi\u1ec7n pagination -->\n<script type=\"text\/javascript\" src=\"templates\/js\/jquery.twbsPagination.js\"><\/script>\n<script type=\"text\/javascript\">\njQuery(document).ready(function($) {\n    \/\/ === Ajax Pagination cho tin t\u1ee9c ===\n    var chuyenmuc = '<?= isset($id_loai) ? $id_loai : '' ?>';\n    $('#pagination-ajax').twbsPagination({\n        totalPages: <?= isset($total_page) ? $total_page : 1 ?>,\n        visiblePages: 2,\n        prev: '<span aria-hidden=\"true\">&laquo;<\/span>',\n        next: '<span aria-hidden=\"true\">&raquo;<\/span>',\n        onPageClick: function(event, page) {\n            $.ajax({\n                url: \"sources\/ajax\/ajax-pagination.php\",\n                type: 'POST',\n                data: {\n                    page: page,\n                    totalPages: '<?= isset($total_page) ? $total_page : 1 ?>',\n                    chuyenmuc: chuyenmuc,\n                    limit: '<?= isset($limit) ? $limit : 6 ?>',\n                    do: 'pagination_tintuc'\n                },\n                success: function(data) {\n                    $('#result').html(data);\n                }\n            });\n        }\n    });\n\n    \/\/ === Ajax load Google News ===\n    $.ajax({\n        url: 'sources\/ajax\/get_google_news.php',\n        dataType: 'json'\n    }).done(function(res) {\n        var $list = $('#google-news-list').empty();\n        if (res.status === 'success') {\n            $.each(res.data, function(i, item) {\n                if (i >= 5) return false; \/\/ Ch\u1ec9 hi\u1ec3n th\u1ecb 5 tin \u0111\u1ea7u\n                var $li = $('<li>');\n                $li.append('<a href=\"'+item.link+'\" target=\"_blank\">'+item.title+'<\/a>');\n                $li.append('<br><small>'+item.pubDate+'<\/small>');\n                $list.append($li);\n            });\n        } else {\n            $list.html('<li>L\u1ed7i t\u1ea3i tin t\u1ee9c.<\/li>');\n        }\n    }).fail(function() {\n        $('#google-news-list').html('<li>Kh\u00f4ng th\u1ec3 k\u1ebft n\u1ed1i.<\/li>');\n    });\n});\n<\/script>\n"},"headers":["Content-Type: application\/json","Accept: application\/json"]}
